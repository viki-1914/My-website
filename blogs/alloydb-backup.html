<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Automating AlloyDB Backup with Cloud Run</title>
  <link rel="stylesheet" href="../style.css">
</head>
<body>
  <header>
    <h1>Automating AlloyDB Backup with Cloud Run</h1>
  </header>
  <main>
    <p>
      Database backups are critical for business continuity. 
      Manual backups are error-prone and time-consuming. 
      By leveraging <strong>Cloud Run</strong>, we can create a serverless, 
      automated process to back up AlloyDB databases reliably and cost-effectively.
    </p>

    <h2>üîπ Why Automate Backups?</h2>
    <ul>
      <li>Ensures regular, consistent backups.</li>
      <li>Reduces risk of human error.</li>
      <li>Supports disaster recovery and compliance.</li>
    </ul>

    <h2>‚öôÔ∏è Architecture Overview</h2>
    <p>
      Here‚Äôs the high-level workflow:
    </p>
    <ol>
      <li><strong>Cloud Scheduler</strong> triggers the backup job on a schedule.</li>
      <li><strong>Pub/Sub</strong> delivers the event to Cloud Run.</li>
      <li><strong>Cloud Run Job</strong> executes the AlloyDB backup command via gcloud SDK.</li>
      <li>Backup is stored in <strong>Cloud Storage</strong>.</li>
    </ol>

    <h2>üõ†Ô∏è Implementation Steps</h2>
    <ol>
      <li>Enable APIs: <code>AlloyDB, Cloud Run, Cloud Scheduler, Pub/Sub</code>.</li>
      <li>Create a Cloud Storage bucket for backups.</li>
      <li>Write a Python script using <code>google-cloud-sdk</code> that runs:
        <pre><code>gcloud alloydb backups create backup-$(date +%Y%m%d) \
--cluster=my-cluster --region=us-central1</code></pre>
      </li>
      <li>Containerize the script (Dockerfile) and deploy it to Cloud Run.</li>
      <li>Set up Cloud Scheduler to publish a message to Pub/Sub daily.</li>
      <li>Grant required IAM roles: <em>AlloyDB Admin, Storage Admin, Pub/Sub Subscriber</em>.</li>
    </ol>

    <h2>‚úÖ Verification</h2>
    <ul>
      <li>Check <code>gcloud alloydb backups list</code> for completed backups.</li>
      <li>Confirm backup files in Cloud Storage.</li>
      <li>Test restore using <code>gcloud alloydb backups restore</code>.</li>
    </ul>

    <h2>üí° Best Practices</h2>
    <ul>
      <li>Encrypt backups with CMEK for compliance.</li>
      <li>Use separate buckets for production vs. dev/test backups.</li>
      <li>Enable monitoring & alerts on backup failures.</li>
    </ul>
  </main>
  <footer>
    <a href="../index.html">‚Üê Back to Home</a>
  </footer>
</body>
</html>
